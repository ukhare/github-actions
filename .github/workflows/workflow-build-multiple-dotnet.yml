name: Build Multiple .NET Projects

on:
  push:
    branches:
      - "main"
      - "release"
  
  pull_request:
  
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        dotnet-version: [ '7.0.x' ]
        project:
          - project-name: 03-app-dotnet
            app-dir: 03-app-dotnet/app-dotnet.csproj
          - project-name: 04-app-dotnet
            app-dir: 04-app-dotnet/app-dotnet.csproj

    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

        - name: Setup .NET ${{ matrix.dotnet-version }}
        uses: actions/setup-dotnet@v4
        with:
          dotnet-version: ${{ matrix.dotnet-version }}

      - name: Build ${{ matrix.project.project-name }}
        uses: ./.github/actions/dotnet-build-action
        with:
          project-name: ${{ matrix.project.project-name }}
          app-dir: ${{ matrix.project.app-dir }}
          build-configuration: Release
          upload_build: true
